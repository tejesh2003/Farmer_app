<form [formGroup]="billForm" class="max-w-xl mx-auto mt-6 space-y-6 p-4 bg-gray-50 rounded-lg shadow">
  <input
    type="number"
    formControlName="farmerId"
    placeholder="Farmer ID"
    class="w-full p-2 border border-gray-300 rounded"
  />

  <div class="grid grid-cols-3 gap-4 text-gray-700 font-semibold mt-4 px-1">
    <div>Fertilizer</div>
    <div>Unit</div>
    <div>Price (₹/unit)</div>
  </div>

  <div formArrayName="fertilizers" class="space-y-2">
    <div
      *ngFor="let fert of fertilizers.controls; let i = index"
      [formGroupName]="i"
      class="grid grid-cols-3 gap-4 items-center bg-white p-2 rounded border"
    >
      <div class="p-2 border border-gray-200 rounded bg-gray-100 text-gray-800">
        {{ fert.get('name')?.value }}
      </div>

      <div class="p-2 border border-gray-200 rounded bg-gray-100 text-gray-800">
        {{ fert.get('unit')?.value }}
      </div>

      <input
        type="number"
        formControlName="price"
        class="p-2 border border-gray-300 rounded w-full"
        placeholder="₹"
      />
    </div>
  </div>

  <button
    type="button"
    (click)="getBill()"
    class="w-full py-2 bg-green-600 text-white rounded hover:bg-green-700 mt-4"
  >
    Get Bill
  </button>
</form>

<!-- Bill Display (unchanged) -->
<div *ngIf="billData" class="space-y-4 mt-6 max-w-xl mx-auto">
  <div class="text-center bg-green-100 text-green-800 font-semibold py-2 rounded text-lg">
    Total Cost: ₹{{ billData.total_cost }}
  </div>

  <div class="text-center text-sm text-gray-700">
    Bill for Farmer ID: {{ billData.farmer_id }}
  </div>

  <div
    *ngFor="let fert of billData.fertilizers | keyvalue"
    class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm"
  >
    <h3 class="text-lg font-semibold text-gray-800 mb-1">{{ fert.key }}</h3>
    <p class="text-sm text-gray-700">Total Quantity: {{ fert.value.total_quantity }} {{ fert.value.unit }}</p>
    <p class="text-sm text-gray-700">Price per Unit: ₹{{ fert.value.price_per_unit }}</p>
    <p class="text-sm text-gray-700 mb-2">Total Cost: ₹{{ fert.value.total_cost }}</p>

    <div class="border-t pt-2">
      <p class="text-sm font-medium text-gray-600">Farms:</p>
      <ul class="list-disc list-inside text-sm text-gray-600">
        <li *ngFor="let f of fert.value.farms">
          Farm {{ f.farm_id }} - {{ f.crop }} - {{ f.quantity }} {{ fert.value.unit }} due on {{ f.due_date }}
        </li>
      </ul>
    </div>
  </div>
</div>
